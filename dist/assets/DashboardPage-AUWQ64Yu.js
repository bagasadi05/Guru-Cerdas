import{j as e,u as he,a as ue,r as c,g as pe,U as fe,C as ye,h as je,i as W,L as B,B as H,S as ee,k as ae,l as be,m as ke,n as le,o as V,p as Ne,q as we,t as ve,P as U,v as _e,w as Ce,A as Se,R as Ie,T as v,x as Ae,s as S}from"./index-D1C6o8KR.js";import{C as $,a as Q,b as Y,c as X,d as te}from"./Card-DQViJwqL.js";import{S as h}from"./Skeleton-CwYXkP0I.js";import{T as Te,a as Re,b as re,c as ne}from"./Tabs-46UBlh0T.js";import{S as Z}from"./Select-D9Pc8JrA.js";import{F as Me}from"./FloatingActionButton-CQmhLiOc.js";import{B as De}from"./BottomSheet-B_e8xa_t.js";const Pe=()=>e.jsxs("div",{className:"cosmic-bg w-full min-h-full p-4 sm:p-6 md:p-8 flex flex-col space-y-8",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-10 w-3/4 md:w-1/2"}),e.jsx(h,{className:"h-5 w-1/2 md:w-1/3"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(h,{className:"h-32 rounded-2xl"}),e.jsx(h,{className:"h-32 rounded-2xl"}),e.jsx(h,{className:"h-32 rounded-2xl"}),e.jsx(h,{className:"h-32 rounded-2xl"})]}),e.jsx("div",{children:e.jsx(h,{className:"h-64 rounded-2xl"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsx(h,{className:"h-72 rounded-2xl"}),e.jsx(h,{className:"h-64 rounded-2xl"})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(h,{className:"h-96 rounded-2xl"})})]})]}),$e=async r=>{var _;const o=new Date().toISOString().slice(0,10),N=new Date().toLocaleDateString("id-ID",{weekday:"long"}),[u,x,p,d,f,a,y,t]=await Promise.all([S.from("students").select("id, name, avatar_url, class_id").eq("user_id",r),S.from("tasks").select("*").eq("user_id",r).neq("status","done").order("due_date"),S.from("schedules").select("*").eq("user_id",r).eq("day",N).order("start_time"),S.from("classes").select("id, name").eq("user_id",r),S.from("attendance").select("status",{count:"exact"}).eq("user_id",r).eq("date",o),S.rpc("get_weekly_attendance_summary"),S.from("academic_records").select("student_id, subject, score, assessment_name").eq("user_id",r),S.from("violations").select("student_id, points").eq("user_id",r)]),I=[u,x,p,d,f,a,y,t].map(n=>n.error).filter(n=>n!==null);if(I.length>0)throw new Error(I.map(n=>n.message).join(", "));const g=((_=f.data)==null?void 0:_.filter(n=>n.status==="Hadir").length)||0;return{students:u.data||[],tasks:x.data||[],schedule:p.data||[],classes:d.data||[],dailyAttendanceSummary:{present:g,total:f.count||0},weeklyAttendance:a.data||[],academicRecords:y.data||[],violations:t.data||[]}},Be=({dashboardData:r})=>{var a,y;const[o,N]=c.useState(null),[u,x]=c.useState(!1),[p,d]=c.useState(null),f=async()=>{if(r){x(!0),d(null);try{const{students:t,academicRecords:I,violations:g,dailyAttendanceSummary:_}=r,n=new Map(r.students.map(m=>[m.name,m.id])),O="Anda adalah asisten guru AI yang cerdas dan proaktif. Analisis data yang diberikan dan hasilkan ringkasan dalam format JSON yang valid. Fokus pada menyoroti pencapaian positif, area yang memerlukan perhatian, dan saran umum. Gunakan Bahasa Indonesia.",R=t.map(m=>{const G=g.filter(b=>b.student_id===m.id).reduce((b,T)=>b+T.points,0),C=I.filter(b=>b.student_id===m.id),D=C.length>0?C.reduce((b,T)=>b+T.score,0)/C.length:null;return{name:m.name,total_violation_points:G,average_score:D?Math.round(D):"N/A"}}),A=`Analisis data guru berikut untuk memberikan wawasan harian. Data Ringkasan: Total Siswa: ${t.length}, Absensi Hari Ini: ${_.present} dari ${t.length} hadir. Data Rinci Siswa (nilai & pelanggaran): ${JSON.stringify(R)} Tugas Anda: 1. Identifikasi 1-2 siswa berprestasi (nilai rata-rata tinggi, 0 poin pelanggaran). 2. Identifikasi 1-2 siswa yang memerlukan perhatian (nilai rata-rata rendah atau poin pelanggaran tinggi). 3. Berikan satu saran fokus untuk kelas secara umum.`,E={type:v.OBJECT,properties:{positive_highlights:{type:v.ARRAY,items:{type:v.OBJECT,properties:{student_name:{type:v.STRING},reason:{type:v.STRING}}}},areas_for_attention:{type:v.ARRAY,items:{type:v.OBJECT,properties:{student_name:{type:v.STRING},reason:{type:v.STRING}}}},class_focus_suggestion:{type:v.STRING}}},j=await Ae.models.generateContent({model:"gemini-2.5-flash",contents:A,config:{systemInstruction:O,responseMimeType:"application/json",responseSchema:E}}),w=JSON.parse(j.text||"{}"),M={...w,positive_highlights:w.positive_highlights.map(m=>({...m,student_id:n.get(m.student_name)})),areas_for_attention:w.areas_for_attention.map(m=>({...m,student_id:n.get(m.student_name)}))};N(M)}catch(t){console.error("AI Insight Error:",t),d("Gagal membuat wawasan AI. Silakan coba lagi.")}finally{x(!1)}}};return u?e.jsxs("div",{className:"space-y-4",children:[e.jsx(h,{className:"h-4 w-1/2"}),e.jsx(h,{className:"h-4 w-full"}),e.jsx(h,{className:"h-4 w-3/4"})]}):p?e.jsx("p",{className:"text-sm text-red-400",children:p}):o?e.jsxs("div",{className:"space-y-4 text-sm",children:[((a=o.positive_highlights)==null?void 0:a.length)>0&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx(le,{className:"w-5 h-5 text-green-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-200",children:"Siswa Berprestasi"}),o.positive_highlights.map(t=>e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[e.jsx(B,{to:`/siswa/${t.student_id}`,className:"font-semibold text-green-600 dark:text-green-400 hover:underline",children:t.student_name}),": ",t.reason]},t.student_name))]})]}),((y=o.areas_for_attention)==null?void 0:y.length)>0&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-yellow-500/20 flex items-center justify-center",children:e.jsx(Se,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-200",children:"Perlu Perhatian"}),o.areas_for_attention.map(t=>e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[e.jsx(B,{to:`/siswa/${t.student_id}`,className:"font-semibold text-yellow-600 dark:text-yellow-400 hover:underline",children:t.student_name}),": ",t.reason]},t.student_name))]})]}),o.class_focus_suggestion&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center",children:e.jsx(ee,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900 dark:text-gray-200",children:"Saran Hari Ini"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:o.class_focus_suggestion})]})]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsxs(H,{onClick:f,disabled:u||!r,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Buat Wawasan Harian dengan AI"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Dapatkan ringkasan performa kelas hari ini."})]})},qe=({data:r})=>{const[o,N]=Ie.useState(null),u=150,x=30,p=20;return e.jsx("div",{className:"w-full h-full flex justify-center items-end",children:e.jsxs("svg",{width:"100%",height:u,"aria-label":"Grafik absensi mingguan",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"barGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",className:"text-sky-500 dark:text-purple-500",stopColor:"currentColor"}),e.jsx("stop",{offset:"100%",className:"text-sky-700 dark:text-blue-500",stopColor:"currentColor"})]})}),r.map((d,f)=>{const a=d.present_percentage>0?d.present_percentage/100*(u-50):5,y=f*(x+p)+p*2,t=u-a-20;return e.jsxs("g",{onMouseEnter:()=>N(f),onMouseLeave:()=>N(null),className:"cursor-pointer group",children:[e.jsx("rect",{x:y,y:t,width:x,height:a,fill:"url(#barGradient)",rx:"4",className:"transition-transform duration-300 animate-grow-bar group-hover:scale-y-105",style:{transformOrigin:"bottom",animationDelay:`${f*100}ms`}}),e.jsx("text",{x:y+x/2,y:u-5,textAnchor:"middle",fontSize:"12",className:"font-semibold fill-gray-500 dark:fill-gray-400",children:d.day.slice(0,3)}),o===f&&e.jsxs("g",{className:"transition-opacity duration-300 animate-fade-in",style:{opacity:1},children:[e.jsx("rect",{x:y-10,y:t-28,width:x+20,height:22,rx:"5",className:"fill-gray-800 dark:fill-gray-900 stroke-gray-500 dark:stroke-purple-400/50"}),e.jsxs("text",{x:y+x/2,y:t-14,textAnchor:"middle",fontSize:"12",fontWeight:"bold",fill:"#fff",children:[Math.round(d.present_percentage),"%"]})]})]},d.day)})]})})},Ke=()=>{var se;const{user:r}=he(),o=ue(),[N,u]=c.useState(new Date),[x,p]=c.useState(!1),[d,f]=c.useState(!1);c.useEffect(()=>{const s=setInterval(()=>u(new Date),6e4);return()=>clearInterval(s)},[]);const{data:a,isLoading:y}=pe({queryKey:["dashboardData",r==null?void 0:r.id],queryFn:()=>$e(r.id),enabled:!!r}),[t,I]=c.useState(""),[g,_]=c.useState(""),[n,O]=c.useState(""),R=c.useMemo(()=>{if(!(a!=null&&a.academicRecords))return[];const s=new Set(a.academicRecords.map(k=>k.subject));return Array.from(s).sort()},[a==null?void 0:a.academicRecords]),A=c.useMemo(()=>{if(!t||!(a!=null&&a.academicRecords))return[];const s=a.academicRecords.filter(l=>l.subject===t&&l.assessment_name).map(l=>l.assessment_name.trim());return[...new Set(s)].filter(Boolean).sort((l,i)=>l.localeCompare(i,void 0,{numeric:!0,sensitivity:"base"}))},[a==null?void 0:a.academicRecords,t]);c.useEffect(()=>{R.length>0&&!t&&I(R[0])},[R,t]),c.useEffect(()=>{A.length>0?_(A[0]):_("")},[A]);const E=s=>{I(s.target.value),_("")},j=c.useMemo(()=>{if(!t||!g||!(a!=null&&a.students)||!(a!=null&&a.academicRecords)||!(a!=null&&a.classes))return[];const s=new Set(a.academicRecords.filter(i=>i.subject===t&&i.assessment_name===g).map(i=>i.student_id)),k=new Map((a.classes||[]).map(i=>[i.id,i.name]));let l=a.students;return n&&(l=l.filter(i=>i.class_id===n)),l.filter(i=>!s.has(i.id)).map(i=>({...i,className:k.get(i.class_id)||"N/A"}))},[t,g,a,n]),w=c.useMemo(()=>a!=null&&a.students?n?a.students.filter(s=>s.class_id===n).length:a.students.length:0,[a==null?void 0:a.students,n]),M=c.useMemo(()=>w===0?0:Math.round((w-j.length)/w*100),[w,j.length]),m=s=>{o(`/siswa/${s}`,{state:{openTab:"grades"}})},G=()=>{if(!t||!g)return;let s=n;!s&&j.length>0&&(s=j[0].class_id),o("/input-massal",{state:{prefill:{mode:"subject_grade",classId:s,subject:t,assessment_name:g}}})};if(y)return e.jsx(Pe,{});const{students:C=[],tasks:D=[],schedule:b=[],classes:T=[],dailyAttendanceSummary:P,weeklyAttendance:ie=[]}=a||{},q=b.map(s=>{var k;return{...s,className:((k=T.find(l=>l.id===s.class_id))==null?void 0:k.name)||s.class_id}}),ce=C.length>0?Math.round(((P==null?void 0:P.present)||0)/C.length*100):0;let J=-1;for(let s=0;s<q.length;s++){const k=q[s],[l,i]=k.start_time.split(":").map(Number),L=new Date(N);if(L.setHours(l,i,0,0),L>N){J=s;break}}const de=[{label:"Total Siswa",value:C.length,icon:fe,link:"/siswa",color:"from-sky-500 to-blue-500",darkColor:"dark:from-sky-500 dark:to-blue-500",description:`${T.length} kelas`},{label:"Kehadiran",value:`${ce}%`,subValue:`${(P==null?void 0:P.present)||0}/${C.length}`,icon:ye,link:"/absensi",color:"from-emerald-500 to-green-500",darkColor:"dark:from-emerald-500 dark:to-green-500",description:"siswa hadir"},{label:"Tugas Aktif",value:D.length,icon:je,link:"/tugas",color:"from-amber-500 to-yellow-500",darkColor:"dark:from-amber-500 dark:to-yellow-500",description:"tugas"},{label:"Jadwal",value:b.length,icon:W,link:"/jadwal",color:"from-violet-500 to-purple-500",darkColor:"dark:from-violet-500 dark:to-purple-500",description:J>=0?`Next: ${(se=b[J])==null?void 0:se.subject.slice(0,8)}...`:"Selesai"}],oe=[{label:"Absensi",icon:_e,link:"/absensi",color:"text-emerald-500",bg:"bg-emerald-100 dark:bg-emerald-900/20"},{label:"Input Nilai",icon:V,link:"/input-massal",color:"text-blue-500",bg:"bg-blue-100 dark:bg-blue-900/20"},{label:"Laporan",icon:Ce,link:"/siswa",color:"text-purple-500",bg:"bg-purple-100 dark:bg-purple-900/20"},{label:"Tugas Baru",icon:U,link:"/tugas",color:"text-amber-500",bg:"bg-amber-100 dark:bg-amber-900/20"}];return e.jsxs("div",{className:"w-full min-h-full p-3 sm:p-4 md:p-6 lg:p-8 flex flex-col space-y-4 sm:space-y-6 md:space-y-8 bg-transparent max-w-7xl mx-auto pb-24 lg:pb-8",children:[e.jsx("header",{className:"flex items-center justify-between h-16 px-1",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date().toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-5 gap-4 sm:gap-6 md:gap-8",children:[e.jsxs("div",{className:"xl:col-span-3 space-y-4 sm:space-y-6 md:space-y-8",children:[e.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4 sm:gap-4",children:de.map(s=>e.jsx(B,{to:s.link,className:"group block h-full",children:e.jsxs($,{className:"px-4 py-3 h-full flex flex-col justify-between group-hover:-translate-y-1 card-shine-hover overflow-hidden relative min-h-[96px]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center bg-gradient-to-br ${s.color} ${s.darkColor} shadow-md text-white`,children:e.jsx(s.icon,{className:"w-5 h-5"})}),s.subValue&&e.jsx("span",{className:"text-[10px] font-medium bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded-full text-gray-600 dark:text-gray-300",children:s.subValue})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white leading-none mb-1",children:s.value}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 font-medium truncate",children:s.label})]})]})},s.label))}),e.jsx(H,{onClick:()=>p(!0),className:"w-full h-12 text-base font-semibold bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 shadow-sm",variant:"ghost",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-amber-500"}),e.jsx("span",{children:"Buka Aksi Cepat"})]})}),e.jsxs($,{className:"animate-pulse-border-glow border-purple-500/50 bg-gradient-to-br from-white/5 to-transparent dark:from-slate-900/80 dark:to-slate-900/50",children:[e.jsx(Q,{children:e.jsxs(Y,{className:"flex items-center gap-3",children:[e.jsx(ae,{className:"w-6 h-6 text-sky-500 dark:text-purple-400"}),"Wawasan Harian AI"]})}),e.jsx(X,{children:e.jsx(Be,{dashboardData:a||null})})]}),e.jsxs($,{children:[e.jsxs(Q,{children:[e.jsx(Y,{children:"Absensi Mingguan"}),e.jsx(te,{children:"Persentase kehadiran selama 5 hari terakhir."})]}),e.jsx(X,{className:"h-[180px] p-2",children:e.jsx(qe,{data:ie})})]}),e.jsxs($,{children:[e.jsxs(Q,{children:[e.jsxs(Y,{className:"flex items-center gap-3",children:[e.jsx(be,{className:"w-6 h-6 text-sky-500 dark:text-purple-400"}),"Pemeriksa Kelengkapan Nilai"]}),e.jsx(te,{children:"Lihat siswa yang belum memiliki nilai untuk penilaian tertentu."})]}),e.jsxs(X,{children:[e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs(Z,{value:n,onChange:s=>O(s.target.value),children:[e.jsx("option",{value:"",children:"Semua Kelas"}),T.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs(Z,{value:t,onChange:E,className:"flex-1",children:[e.jsx("option",{value:"",disabled:!0,children:"Pilih Mata Pelajaran"}),R.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs(Z,{value:g,onChange:s=>_(s.target.value),className:"flex-1",disabled:A.length===0,children:[e.jsx("option",{value:"",disabled:!0,children:"Pilih Penilaian"}),A.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),t&&g&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["Progres Kelengkapan (",w-j.length,"/",w,")"]}),e.jsxs("span",{className:`font-bold ${M===100?"text-green-500":"text-blue-500"}`,children:[M,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 dark:bg-gray-700 overflow-hidden",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${M===100?"bg-green-500":"bg-blue-500"}`,style:{width:`${M}%`}})})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto space-y-1 pr-2",children:t&&g?j.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2 px-1",children:[j.length," SISWA BELUM DINILAI:"]}),j.map(s=>e.jsxs("div",{onClick:()=>m(s.id),className:"flex items-center gap-3 p-2 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-white/5 transition-colors",children:[e.jsx("img",{src:s.avatar_url,alt:s.name,className:"w-9 h-9 rounded-full object-cover"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Kelas ",s.className]})]}),e.jsx(ke,{className:"w-5 h-5 ml-auto text-gray-400"})]},s.id))]}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-8 bg-green-500/5 dark:bg-green-500/10 rounded-lg animate-fade-in",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-500/20 rounded-full flex items-center justify-center mb-4",children:e.jsx(le,{className:"w-10 h-10 text-green-600 dark:text-green-400"})}),e.jsx("p",{className:"font-bold text-lg text-green-700 dark:text-green-300",children:"Semua Siswa Lengkap!"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Kerja bagus, nilai untuk penilaian ini sudah lengkap."})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(V,{className:"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500"}),e.jsx("p",{className:"font-semibold",children:"Pilih Mata Pelajaran & Penilaian"}),e.jsx("p",{className:"text-sm",children:"Pilih subjek dan penilaian di atas untuk melihat siapa saja yang masih memerlukan nilai."})]})}),j.length>0&&t&&g&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-white/10",children:[e.jsxs(H,{onClick:G,className:"w-full",size:"sm",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Lengkapi via Input Massal"]}),e.jsx("p",{className:"text-xs text-center text-gray-400 mt-2",children:n?"Buka halaman input untuk kelas ini.":"Buka halaman input (pilih kelas otomatis)."})]})]})]})]}),e.jsx("div",{className:"xl:col-span-2 space-y-8",children:e.jsx($,{className:"h-full max-h-[700px] flex flex-col",children:e.jsxs(Te,{defaultValue:"schedule",className:"w-full flex flex-col h-full",children:[e.jsxs(Re,{className:"m-4 self-center",children:[e.jsx(re,{value:"schedule",children:"Jadwal Hari Ini"}),e.jsx(re,{value:"tasks",children:"Tugas Mendatang"})]}),e.jsx(ne,{value:"schedule",className:"flex-1 overflow-y-auto px-6 pb-6",children:e.jsx("div",{className:"relative space-y-3",children:q.length>0?e.jsx("div",{className:"space-y-4 pl-2",children:q.map((s,k)=>{const l=N,[i,L]=s.start_time.split(":").map(Number),[me,xe]=s.end_time.split(":").map(Number),K=new Date(l);K.setHours(i,L,0,0);const F=new Date(l);F.setHours(me,xe,0,0);const ge=l>F,z=l>=K&&l<=F;return e.jsxs("div",{className:"relative flex gap-4 items-start group",children:[k<q.length-1&&e.jsx("div",{className:"absolute left-8 top-10 bottom-[-20px] w-0.5 bg-gray-200 dark:bg-gray-800 group-last:hidden"}),e.jsx("div",{className:"flex-shrink-0 w-16 pt-1 z-10",children:e.jsxs("div",{className:`
                                                                rounded-lg px-2 py-1.5 text-center border
                                                                ${z?"bg-sky-100 border-sky-200 text-sky-700 dark:bg-sky-900/30 dark:border-sky-800 dark:text-sky-300":"bg-gray-50 border-gray-100 text-gray-600 dark:bg-gray-900 dark:border-gray-800 dark:text-gray-400"}
                                                            `,children:[e.jsx("time",{className:"text-xs font-bold block",children:s.start_time.slice(0,5)}),e.jsx("span",{className:"text-[10px] opacity-80",children:s.end_time.slice(0,5)})]})}),e.jsxs($,{className:`
                                                            flex-1 p-4 transition-all duration-200 min-h-[72px]
                                                            ${z?"ring-2 ring-sky-500 shadow-md":"hover:bg-gray-50 dark:hover:bg-gray-900"}
                                                            ${ge?"opacity-60":""}
                                                        `,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"font-bold text-base text-gray-900 dark:text-white",children:s.subject}),z&&e.jsxs("span",{className:"flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-2 w-2 rounded-full bg-sky-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-sky-500"})]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:s.className}),e.jsx("div",{className:"flex items-center gap-3 text-xs text-gray-500 dark:text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"w-3.5 h-3.5"}),e.jsxs("span",{children:[Math.round((F.getTime()-K.getTime())/6e4)," menit"]})]})})]})]},s.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center text-gray-500 dark:text-gray-400",children:[e.jsx(W,{className:"w-12 h-12 mb-3 opacity-20"}),e.jsx("p",{children:"Tidak ada jadwal hari ini."})]})})}),e.jsxs(ne,{value:"tasks",className:"flex-1 overflow-y-auto px-6 pb-6",children:[e.jsx("div",{className:"space-y-3",children:D.length>0?D.slice(0,10).map(s=>e.jsxs("div",{className:"p-3 bg-gray-100 dark:bg-black/20 rounded-lg",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:s.title}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Jatuh tempo: ",s.due_date?new Date(s.due_date).toLocaleDateString("id-ID"):"Tidak ada"]})]},s.id)):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"Tidak ada tugas aktif."})}),e.jsx("div",{className:"mt-4",children:e.jsx(H,{variant:"outline",size:"sm",onClick:()=>o("/tugas"),className:"w-full",children:"Lihat Semua Tugas"})})]})]})})})]}),e.jsxs("div",{className:"fixed bottom-20 right-4 lg:bottom-8 lg:right-8 z-40 flex flex-col items-end gap-3",children:[d&&e.jsxs("div",{className:"flex flex-col gap-3 animate-fade-in-up",children:[e.jsxs(B,{to:"/jadwal",className:"flex items-center gap-3 pr-1 group",children:[e.jsx("span",{className:"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-lg shadow-md text-sm font-medium opacity-0 group-hover:opacity-100 transition-opacity",children:"Jadwal"}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-white dark:bg-gray-800 text-orange-600 dark:text-orange-400 shadow-lg flex items-center justify-center hover:scale-110 transition-transform",children:e.jsx(W,{className:"w-5 h-5"})})]}),e.jsxs("button",{onClick:()=>{var s;return(s=window.toggleSearch)==null?void 0:s.call(window)},className:"flex items-center gap-3 pr-1 group",children:[e.jsx("span",{className:"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-lg shadow-md text-sm font-medium opacity-0 group-hover:opacity-100 transition-opacity",children:"Cari"}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-white dark:bg-gray-800 text-sky-600 dark:text-sky-400 shadow-lg flex items-center justify-center hover:scale-110 transition-transform",children:e.jsx(we,{className:"w-5 h-5"})})]}),e.jsxs("button",{onClick:()=>{var s;return(s=window.toggleAiChat)==null?void 0:s.call(window)},className:"flex items-center gap-3 pr-1 group",children:[e.jsx("span",{className:"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-lg shadow-md text-sm font-medium opacity-0 group-hover:opacity-100 transition-opacity",children:"AI Chat"}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-white dark:bg-gray-800 text-purple-600 dark:text-purple-400 shadow-lg flex items-center justify-center hover:scale-110 transition-transform",children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs(B,{to:"/pengaturan",className:"flex items-center gap-3 pr-1 group",children:[e.jsx("span",{className:"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 px-3 py-1.5 rounded-lg shadow-md text-sm font-medium opacity-0 group-hover:opacity-100 transition-opacity",children:"Pengaturan"}),e.jsx("div",{className:"w-12 h-12 rounded-full bg-white dark:bg-gray-800 text-gray-600 dark:text-gray-400 shadow-lg flex items-center justify-center hover:scale-110 transition-transform",children:e.jsx(ve,{className:"w-5 h-5"})})]})]}),e.jsx(Me,{onClick:()=>f(!d),icon:d?e.jsx(U,{className:"w-6 h-6 rotate-45 transition-transform"}):e.jsx(U,{className:"w-6 h-6 transition-transform"}),className:d?"bg-red-500 hover:bg-red-600 dark:bg-red-600":"",position:"bottom-right",offset:{bottom:0,right:0}})]}),e.jsx(De,{isOpen:x,onClose:()=>p(!1),title:"Aksi Cepat",children:e.jsx("div",{className:"grid grid-cols-2 gap-4",children:oe.map(s=>e.jsxs(B,{to:s.link,onClick:()=>p(!1),className:`
                                flex flex-col items-center justify-center p-4 rounded-xl min-h-[88px]
                                ${s.bg} hover:opacity-80 transition-opacity
                                border border-transparent hover:border-gray-200 dark:hover:border-gray-700
                            `,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center bg-white dark:bg-gray-800 shadow-sm mb-2 ${s.color}`,children:e.jsx(s.icon,{className:"w-6 h-6"})}),e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:s.label})]},s.label))})})]})};export{Ke as default};

import{a as k,r as n,j as e,L as f,s as x}from"./index-D1C6o8KR.js";const v=()=>{const m=k(),[o,g]=n.useState(""),[i,t]=n.useState(!1),[c,a]=n.useState(null),p=async r=>{r.preventDefault(),t(!0),a(null);const l=o.trim();if(!l){a("Kode akses tidak boleh kosong."),t(!1);return}const{data:s,error:d}=await x.rpc("verify_access_code",{access_code_param:l});if(t(!1),d){console.error("Supabase portal login RPC error:",d),a("Gagal memverifikasi kode. Ini mungkin disebabkan oleh konfigurasi database (RLS/Functions). Pastikan fungsi di Supabase sudah benar.");return}if(!s||s.length===0){a("Kode akses tidak valid. Pastikan Anda memasukkan kode yang benar dari guru.");return}if(s.length>1){a("Ditemukan beberapa siswa dengan kode akses yang mirip. Harap hubungi guru Anda untuk kode yang unik.");return}const u=s[0];sessionStorage.setItem("portal_access_code",u.access_code),m(`/portal/${u.id}`)},b=()=>document.body.setAttribute("data-focused","true"),h=()=>document.body.setAttribute("data-focused","false");return e.jsx("div",{className:"flex items-center justify-center min-h-screen animate-page-transition",children:e.jsxs("div",{className:"login-card",children:[e.jsx("div",{className:"holographic-orb-container",children:e.jsxs("div",{className:"holographic-orb",children:[e.jsx("div",{className:"orb-glow"}),e.jsx("div",{className:"orb-core"}),e.jsx("div",{className:"orb-ring orb-ring-1"}),e.jsx("div",{className:"orb-ring orb-ring-2"})]})}),e.jsx("h1",{className:"form-title",children:"Portal Siswa"}),e.jsx("p",{className:"form-subtitle",children:"Masukkan kode akses yang diberikan oleh guru Anda."}),e.jsxs("form",{onSubmit:p,children:[e.jsx("div",{className:"form-group-icon",children:e.jsx("input",{type:"text",placeholder:"KODE AKSES",required:!0,value:o,onChange:r=>g(r.target.value.toUpperCase()),onFocus:b,onBlur:h,"aria-label":"Kode Akses",autoCapitalize:"characters",autoComplete:"off",autoCorrect:"off",spellCheck:"false",maxLength:6,className:"text-center font-bold tracking-[0.3em] uppercase",style:{paddingLeft:"15px",paddingRight:"15px"}})}),c&&e.jsx("p",{className:"text-center text-sm text-yellow-300 mb-4",children:c}),e.jsx("button",{type:"submit",className:"form-btn",disabled:i,children:i?"Memverifikasi...":"Lanjutkan"})]}),e.jsx("div",{className:"text-center mt-6 border-t border-white/10 pt-4",children:e.jsx(f,{to:"/",className:"form-links a",children:"Kembali ke pemilihan peran"})})]})})};export{v as default};

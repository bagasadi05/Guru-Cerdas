import{a as X,u as Y,b as Z,r as t,j as a,M as C,I as o,c as f,E as I,d as K,e as _,L as aa,f as sa,B,s as ea}from"./index-D1C6o8KR.js";import{o as O,s as n,u as G,a as D}from"./schemas-CDlXmjzF.js";const ra=O({email:n().email("Email tidak valid"),password:n().min(1,"Password harus diisi")}),ta=O({name:n().min(1,"Nama lengkap harus diisi"),email:n().email("Email tidak valid"),password:n().min(6,"Password minimal 6 karakter"),confirmPassword:n().min(1,"Konfirmasi password harus diisi")}).refine(l=>l.password===l.confirmPassword,{message:"Password tidak cocok",path:["confirmPassword"]}),na=()=>{var P,E,L,M,F,A;const l=X(),{login:T,signup:z,session:k}=Y(),m=Z(),[q,j]=t.useState("login"),[c,d]=t.useState(!1),[r,w]=t.useState(!1),[R,u]=t.useState(!1),[h,y]=t.useState(""),[x,b]=t.useState(!1),{register:N,handleSubmit:U,formState:{errors:v},reset:$}=G({resolver:D(ra)}),{register:p,handleSubmit:H,formState:{errors:g},reset:S}=G({resolver:D(ta)});t.useEffect(()=>{k&&l("/dashboard",{replace:!0})},[k,l]);const J=async e=>{d(!0);try{const{error:s}=await T(e.email,e.password);if(s)throw s}catch(s){m.error(s.message||"Gagal untuk login.")}finally{d(!1)}},Q=async e=>{d(!0);try{const s=await z(e.name,e.email,e.password);if(s.error)throw s.error;s.data.user&&(m.success("Pendaftaran berhasil! Silakan periksa email Anda untuk verifikasi."),j("login"),S())}catch(s){m.error(s.message||"Gagal untuk mendaftar.")}finally{d(!1)}},V=async e=>{e.preventDefault(),b(!0);try{const{error:s}=await ea.auth.resetPasswordForEmail(h,{redirectTo:window.location.origin+"/"});if(s)throw s;m.success(`Email pemulihan telah dikirim ke ${h}. Silakan periksa kotak masuk Anda.`),u(!1),y("")}catch(s){m.error(s.message||"Gagal mengirim email pemulihan.")}finally{b(!1)}},i=q==="login",W=()=>{j(i?"signup":"login"),$(),S()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"flex items-center justify-center min-h-screen animate-page-transition",children:a.jsxs("div",{className:"login-card",children:[a.jsx("h1",{className:"form-title",children:i?"Selamat Datang Kembali":"Buat Akun Guru"}),a.jsx("p",{className:"form-subtitle",children:i?"Masuk untuk melanjutkan ke Portal Guru":"Satu langkah lagi menuju kelas digital Anda."}),i?a.jsxs("form",{onSubmit:U(J),className:"space-y-4",children:[a.jsxs("div",{className:"form-group-icon",children:[a.jsx(C,{className:"icon h-5 w-5"}),a.jsx(o,{type:"email",placeholder:"Email",...N("email"),error:(P=v.email)==null?void 0:P.message,className:"pl-10"})]}),a.jsxs("div",{className:"form-group-icon relative",children:[a.jsx(f,{className:"icon h-5 w-5"}),a.jsx(o,{type:r?"text":"password",placeholder:"Password",...N("password"),error:(E=v.password)==null?void 0:E.message,className:"pl-10 pr-10"}),a.jsx("button",{type:"button",onClick:()=>w(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 z-10",children:r?a.jsx(I,{className:"h-5 w-5"}):a.jsx(K,{className:"h-5 w-5"})})]}),a.jsx("button",{type:"submit",className:"form-btn",disabled:c,children:c?"Memproses...":"Masuk"})]}):a.jsxs("form",{onSubmit:H(Q),className:"space-y-4",children:[a.jsxs("div",{className:"form-group-icon",children:[a.jsx(_,{className:"icon h-5 w-5"}),a.jsx(o,{type:"text",placeholder:"Nama Lengkap",...p("name"),error:(L=g.name)==null?void 0:L.message,className:"pl-10"})]}),a.jsxs("div",{className:"form-group-icon",children:[a.jsx(C,{className:"icon h-5 w-5"}),a.jsx(o,{type:"email",placeholder:"Email",...p("email"),error:(M=g.email)==null?void 0:M.message,className:"pl-10"})]}),a.jsxs("div",{className:"form-group-icon relative",children:[a.jsx(f,{className:"icon h-5 w-5"}),a.jsx(o,{type:r?"text":"password",placeholder:"Password",...p("password"),error:(F=g.password)==null?void 0:F.message,className:"pl-10 pr-10"}),a.jsx("button",{type:"button",onClick:()=>w(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 z-10",children:r?a.jsx(I,{className:"h-5 w-5"}):a.jsx(K,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"form-group-icon relative",children:[a.jsx(f,{className:"icon h-5 w-5"}),a.jsx(o,{type:r?"text":"password",placeholder:"Konfirmasi Password",...p("confirmPassword"),error:(A=g.confirmPassword)==null?void 0:A.message,className:"pl-10 pr-10"})]}),a.jsx("button",{type:"submit",className:"form-btn",disabled:c,children:c?"Memproses...":"Daftar"})]}),a.jsxs("div",{className:"form-links",children:[a.jsx("button",{type:"button",onClick:W,children:i?"Belum punya akun? Daftar":"Sudah punya akun? Masuk"}),i&&a.jsx("button",{type:"button",onClick:()=>u(!0),children:"Lupa password?"})]}),a.jsx("div",{className:"text-center mt-6 border-t border-gray-200 dark:border-white/10 pt-4",children:a.jsx(aa,{to:"/",className:"form-links a",children:"Kembali ke pemilihan peran"})})]})}),a.jsx(sa,{title:"Lupa Password",isOpen:R,onClose:()=>u(!1),children:a.jsxs("form",{onSubmit:V,className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Masukkan alamat email Anda. Kami akan mengirimkan tautan untuk mengatur ulang password Anda."}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"forgot-email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),a.jsx(o,{type:"email",id:"forgot-email",placeholder:"Email terdaftar Anda",required:!0,value:h,onChange:e=>y(e.target.value)})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(B,{type:"button",variant:"ghost",onClick:()=>u(!1),disabled:x,children:"Batal"}),a.jsx(B,{type:"submit",disabled:x,children:x?"Mengirim...":"Kirim Tautan"})]})]})})]})};export{na as default};
